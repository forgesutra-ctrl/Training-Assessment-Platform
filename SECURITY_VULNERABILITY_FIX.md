# Security Vulnerability Fix - xlsx Package

## Issue

The `xlsx` package (version 0.18.5) has **high severity vulnerabilities**:
- Prototype Pollution in sheetJS
- SheetJS Regular Expression Denial of Service (ReDoS)
- **No fix available** in current version

## Solutions

### Option 1: Update to Latest Version (Recommended)

Try updating to the latest version:

```bash
npm install xlsx@latest
```

However, the vulnerability may still exist if it's not patched yet.

### Option 2: Use Alternative Library (Best for Production)

Replace `xlsx` with `exceljs` which is actively maintained and more secure:

```bash
npm uninstall xlsx
npm install exceljs
```

Then update `src/utils/reporting.ts` to use `exceljs` instead.

### Option 3: Accept Risk (Not Recommended)

If Excel export is not critical, you could:
- Remove Excel export functionality
- Use CSV export only (already implemented)
- Add a warning in the UI about Excel export limitations

## Impact Assessment

**Risk Level:** High (but limited exposure)
- Only affects Excel export functionality
- Requires user interaction (clicking export button)
- Not a critical feature for core functionality

**Recommendation:** 
- For production: Use Option 2 (exceljs)
- For development: Can proceed with current version if Excel export is not critical

## Files That Need Updates

If switching to `exceljs`:
- `src/utils/reporting.ts` - Update `exportToExcel` function
- `package.json` - Replace xlsx with exceljs

## Quick Fix (If Excel Export Not Critical)

You can disable Excel export temporarily:

1. Comment out Excel export buttons
2. Keep CSV and PDF exports (they don't use xlsx)
3. Add a note: "Excel export temporarily unavailable"

This allows the app to function while you decide on a permanent solution.
